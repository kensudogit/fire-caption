<div class="dashboard-container">
  <div class="dashboard-header">
    <h1>Fire Captain Dashboard</h1>
    <p class="subtitle">Real-time emergency response monitoring</p>
  </div>

  <div class="stats-grid" *ngIf="!loading">
    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-content">
          <mat-icon class="stat-icon total">emergency</mat-icon>
          <div class="stat-details">
            <div class="stat-number">{{ totalCalls }}</div>
            <div class="stat-label">Total Calls</div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-content">
          <mat-icon class="stat-icon active">local_fire_department</mat-icon>
          <div class="stat-details">
            <div class="stat-number">{{ activeCalls }}</div>
            <div class="stat-label">Active Calls</div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-content">
          <mat-icon class="stat-icon pending">schedule</mat-icon>
          <div class="stat-details">
            <div class="stat-number">{{ pendingCalls }}</div>
            <div class="stat-label">Pending</div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card">
      <mat-card-content>
        <div class="stat-content">
          <mat-icon class="stat-icon completed">check_circle</mat-icon>
          <div class="stat-details">
            <div class="stat-number">{{ completedCalls }}</div>
            <div class="stat-label">Completed</div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <div class="dashboard-content" *ngIf="!loading">
    <div class="content-grid">
      <!-- Chart Section -->
      <mat-card class="chart-card">
        <mat-card-header>
          <mat-card-title>Call Status Distribution</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <canvas baseChart
                  [data]="chartData"
                  [type]="'doughnut'"
                  [options]="chartOptions">
          </canvas>
        </mat-card-content>
      </mat-card>

      <!-- Recent Calls Section -->
      <mat-card class="recent-calls-card">
        <mat-card-header>
          <mat-card-title>Recent Emergency Calls</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="calls-list" *ngIf="recentCalls.length > 0; else noCalls">
            <div class="call-item" *ngFor="let call of recentCalls">
              <div class="call-header">
                <span class="call-number">{{ call.callNumber }}</span>
                <mat-chip [style.background-color]="getStatusColor(call.status)">
                  {{ call.status }}
                </mat-chip>
              </div>
              <div class="call-details">
                <p class="call-address">{{ call.incidentAddress }}</p>
                <p class="call-type">{{ call.incidentType }}</p>
                <div class="call-meta">
                  <span class="call-time">{{ call.receivedAt | date:'short' }}</span>
                  <mat-chip [style.background-color]="getPriorityColor(call.priorityLevel)" class="priority-chip">
                    {{ call.priorityLevel }}
                  </mat-chip>
                </div>
              </div>
            </div>
          </div>
          <ng-template #noCalls>
            <div class="no-calls">
              <mat-icon>check_circle</mat-icon>
              <p>No active emergency calls</p>
            </div>
          </ng-template>
        </mat-card-content>
      </mat-card>
    </div>
  </div>

  <!-- Loading Spinner -->
  <div class="loading-container" *ngIf="loading">
    <mat-spinner></mat-spinner>
    <p>Loading dashboard data...</p>
  </div>
</div>
